$(document).ready(function(){function t(){return colors=["black","red","green","turquoise"],colors[Math.floor(Math.random()*colors.length)]}user_id=$("#user_id p").text(),access_token=$("#access_token p").text();var s=io.connect();s.emit("initial story",{user_id:user_id,access_token:access_token}),s.on("user message",function(t){$("#messages").append(t)}),s.on("story",function(e){console.log("received story",e),$(".story").html(""),$("#submit").removeAttr("disabled"),$("#threewords").removeAttr("disabled"),$("#threewords").val(""),$("#messages").html("");var r=e.snippets;for(var o in r){var i="<span snippet_index="+o+" "+'img_url="'+r[o].img_url+'">'+r[o].words.join(" ")+"</span>"+"&nbsp;";$(".story").append(i)}$("#bebas_quote").attr("src","images/bebas_quote_"+t()+".png"),$("#storytitle").html(e.name),$("#tumblr_img").attr("src",r[r.length-1].img_url),$(".story").append('<span style="border-bottom:1px solid red;color:#fcfbf7">Your Three Words</span>'),$(".story").attr("story_id",e.story_id),$(".story span").mouseover(function(){$("#tumblr_img").attr("src",$(this).attr("img_url"))}),$(".story span").click(function(){$(this).popover({html:!0,content:function(){return $("#flagspam").attr({story_id:$(".story").attr("story_id"),snippet_index:$(this).attr("snippet_index")}),$("#spamflag_wrapper").html()},placement:"top"}),$(this).popover("toggle"),$(".popover-content #flagspam").click(function(){var t={submitted_by:user_id,story_id:$(this).attr("story_id"),snippet_index:$(this).attr("snippet_index")};s.emit("report spam",t),$(".story span").popover("destroy"),$(".story span[snippet_index="+t.snippet_index+"]").remove(),$("#messages").append('<div class="alert alert-info"><button type="button" class="close" data-dismiss="alert">Ã—</button>Snippet flagged as spam. Thanks for beinga good citizen!</div>')})})}),$("#threewords").keypress(function(t){t.which==13&&$("#submit").click()}),$("#submit").bind("click",function(){$("#submit").attr("disabled",""),$("#threewords").attr("disabled","");var t={string:$("#threewords").val(),story_id:$(".story").attr("story_id"),access_token:access_token,user_id:user_id};s.emit("submit",t)}),$("#playbutton").focus()})